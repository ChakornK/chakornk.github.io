---
import Layout from "@/layouts/Layout.astro";
import { Icon } from "astro-icon/components";
import ProjectLinks from "@/components/ProjectLinks.astro";
import SkillList from "@/components/SkillList.astro";

const matches = import.meta.glob("/projects/*.md", { eager: true });
const projects = Object.entries(matches).map(([k, p]) => ({
  id: k.split("/").slice(-1)[0].split(".")[0],
  ...(p as { frontmatter: any }).frontmatter,
})) as Record<string, any>[];
---

<Layout title="Projects" description="What I've worked on">
  <main class="flex h-full flex-col items-center p-8 pt-24 sm:p-16">
    <div class="flex w-full max-w-2xl flex-col gap-4">
      <h1 class="text-3xl">Projects</h1>
      {
        projects.map((project) => (
          <div class="flex cursor-pointer flex-col gap-2 border border-neutral-950 p-4 text-sm" onclick="this.querySelector('a').click()">
            <div class="flex justify-between">
              <a href={`/projects/${project.id}`} class="hidden" />
              <h2 class="text-lg leading-none">{project.name}</h2>
              <ProjectLinks {...project} />
            </div>
            <p>{project.description}</p>
            <SkillList items={project.skills.split(/, ?/)} />
          </div>
        ))
      }
    </div>
  </main>
</Layout>
